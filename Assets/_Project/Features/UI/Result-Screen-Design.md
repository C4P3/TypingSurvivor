**実装に関する注記:** この画面のアーキテクチャはリファクタリングされました。ビジュアルと機能の仕様は同じですが、実装は結果ごとに個別のViewスクリプトを使用する形ではなくなりました。代わりに、統合されたコントローラー（`SinglePlayerResultView`, `MultiplayerResultView`）と、データ駆動の`AnimationSequencer`コンポーネントを使用します。各結果のレイアウトは、4つの異なるPrefabで管理されます。

---

# **リザルト画面 設計ドキュメント**

## 1. 目的

このドキュメントは、全ゲームモード（シングルプレイ、ランクマッチ、フリーマッチ）におけるリザルト画面の構造、表示要素、および演出フローを定義します。

## 2. 基本構造と演出フロー

リザルト画面は、`ResultScreen.cs`によって制御される、複数のパネルから構成される複合UIです。ゲーム終了後、以下のシーケンスで各情報が時間差で表示されます。プレイヤーは画面をクリックすることで、各ステップの待機時間をスキップできます。

1.  **勝敗バナー表示 (約5秒)**: 「YOU WIN」「GAME OVER」といった結果が画面中央に大きく表示されます。
2.  **基本統計表示**: 今回のタイムや自己ベストなど、基本的な結果が表示されます。
3.  **特別リザルト表示（条件付き）**:
    *   **ハイスコア更新時 (約5秒)**: 自己ベストを更新した場合、「New Record!」といった特別な演出が表示され、待機時間が入ります。
    *   **ランク情報表示時 (約5秒)**: リーダーボードの順位が取得できた場合、順位やパーセンタイルが表示され、待機時間が入ります。
    *   **レート変動表示時 (ランクマッチのみ、約5秒)**: レートの増減がアニメーション付きで表示され、待機時間が入ります。
4.  **詳細統計表示**: 全プレイヤーの破壊ブロック数やミスなどの詳細なデータが表示されます。
5.  **アクションボタン表示**: 「再戦」や「メインメニューへ」といった、次の行動を選択するボタンが表示されます。

## 3. ゲームモードごとの表示要素

### 3.1. シングルプレイモード

| 要素 | 表示内容 | データソース | 備考 |
| :--- | :--- | :--- | :--- |
| **結果** | 生存時間 (例: `TIME: 05:32:12`) | `GameResultDto.FinalPlayerDatas[0]` | スコアの代わりに生存時間を表示 |
| **自己ベスト** | 自己ベストタイム (例: `BEST: 06:15:00`) | `CloudSaveService` | 今回の記録が自己ベストだった場合は、特別な演出（「New Record!」など）が入る |
| **順位** | 上位パーセンタイル (例: `TOP 15%`) | `SurvivalLeaderboardService` | Leaderboard上の順位から算出 |
| **詳細** | ・破壊ブロック数<br>・タイプミス数 | `GameResultDto.FinalPlayerDatas[0]` | |
| **ボタン** | ・もう一度<br>・メインメニューへ | N/A | |

### 3.2. ランクマッチモード

| 要素 | 表示内容 | データソース | 備考 |
| :--- | :--- | :--- | :--- |
| **結果** | `YOU WIN` / `YOU LOSE` / `DRAW` | `GameResultDto` | |
| **対戦時間** | 対戦全体の時間 (例: `MATCH TIME: 03:45:88`) | `GameResultDto` | |
| **レート変動** | レートの増減 (例: `1500 → 1523 (+23)`) | `GameResultDto` | |
| **プレイヤー統計** | ・**プレイヤー名**<br>・破壊ブロック数<br>・タイプミス数 | `GameResultDto.FinalPlayerDatas` | 対戦相手と自分の両方の情報を表示 |
| **ボタン** | ・再戦<br>・メインメニューへ | N/A | |

### 3.3. フリーマッチモード

ランクマッチから「レート変動」の表示をなくしたものと同一です。

| 要素 | 表示内容 | データソース | 備考 |
| :--- | :--- | :--- | :--- |
| **結果** | `YOU WIN` / `YOU LOSE` / `DRAW` | `GameResultDto` | |
| **対戦時間** | 対戦全体の時間 (例: `MATCH TIME: 03:45:88`) | `GameResultDto` | |
| **プレイヤー統計** | ・**プレイヤー名**<br>・破壊ブロック数<br>・タイプミス数 | `GameResultDto.FinalPlayerDatas` | 対戦相手と自分の両方の情報を表示 |
| **ボタン** | ・再戦<br>・メインメニューへ | N/A | |