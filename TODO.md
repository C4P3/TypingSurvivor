# TODOリスト

このドキュメントは、Typing Survivorプロジェクトの未実装の機能や改善点を管理するためのタスクリストです。
タスクは優先度が高いと思われる順に並んでいます。

## 優先度: 高

- [ ] **`PlayerInput.cs`のリファクタリング**:
  - `EnableGameplayInput`と`EnableTypingInput`メソッドは、単一アクションマップへの移行という新しい設計思想と一致していません。これらのメソッドを削除し、関連するコードをリファクタリングして、設計との一貫性を確保する必要があります。
- [ ] **`RoomingState.cs`のファイル名変更**:
  - `RoomingState.cs`は明らかに`RoamingState.cs`のタイプミスです。ファイル名を修正し、コード内のすべての参照を更新する必要があります。

## 優先度: 中

- [ ] **`GameUIManager.cs`の責務分割**:
  - 現在`GameUIManager`が担当している低酸素エフェクトのロジックを、専用の`LowOxygenEffectController`クラスに分離することを検討します。
- [ ] **`PlayerFacade.cs`の責務分割**:
  - `ContinuousMove_Server`コルーチン内の移動ロジックを、専用の`PlayerMovement`クラスに分離し、`PlayerFacade`の肥大化を抑制することを検討します。
- [ ] **`CloudSaveService.cs`のリファクタリング**:
  - クライアントサイドとサーバーサイドのロジックが混在しているため、`#region`や`partial`クラスを用いてコードの可読性を向上させることを検討します。
  - `Newtonsoft.Json`への依存について、`JsonUtility`での代替が可能か調査し、不可能であれば依存ライブラリとして明記します。
- [ ] **デバッグ用`OnGUI`コードの管理**:
  - `GameUIManager.cs`と`UIFlowCoordinator.cs`内の`OnGUI`メソッドが、本番ビルドに含まれないように、`UNITY_EDITOR`プリプロセッサで囲むなどの対策を徹底します。
- [ ] **`BombEffect.cs`の改善**:
  - `BombEffect`の爆発半径がハードコードされています。これを`BombEffect`の`ScriptableObject`から設定可能にすることを検討します。

## 優先度: 低

- [ ] **`UIFlowCoordinator.cs`のステートマシン改善**:
  - 巨大な`switch`文で実装されている現在のステートマシンを、よりオブジェクト指向的なStateパターンにリファクタリングすることを検討します。
- [ ] **`LevelManager.cs`の改善**:
  - ハードコードされている`_chunkSize`を`GameConfig`などから設定可能にすることを検討します。
  - `_useRandomSeed`フラグが本番ビルドで有効にならないための警告やチェック機構の導入を検討します。
- [ ] **`WordProvider.cs`の改善**:
  - 単語データベースが空だった場合のフォールバック言語("ja")がハードコードされているため、これを`GameConfig`などで設定可能にすることを検討します。
- [ ] **`InGameHUDManager.cs`の可読性向上**:
  - 多数存在する`if (xxx != null)`のチェックを、null条件演算子(`?.`)に置き換えてコードを簡潔にすることを検討します。
- [ ] **`MusicManager.cs`の`NetworkBehaviour`**:
  - `MusicManager`は`NetworkBehaviour`を継承していますが、シングルトンとしてのみ使用されています。この継承が本当に必要か、あるいはネットワーク機能を持たせるべきか、設計を再検討します。
- [ ] **`ItemService.cs`の汎用化**:
  - `ItemService`が`ILevelService`に依存している現状を、より汎用的な`IWorldService`のようなインターフェースへの依存に切り替えることで、再利用性を高めることを検討します。
- [ ] **`PlayerInput.cs`の改善**:
  - `GameControls`クラスへのハードコードされた参照を、インターフェースと依存性注入を用いるようにリファクタリングすることを検討します。
- [ ] **`PlayerView.cs`の実装**:
  - 現在プレースホルダーとなっている`PlayerView.cs`に、アニメーションやエフェクトなどの実際のビューロジックを実装します。
- [ ] **`TypingChallenge.cs`の最適化**:
  - `GetRemainingRomaji`メソッドの結果をキャッシュすることで、パフォーマンスを向上させることを検討します。
- [ ] **`KanaParser.cs`と`TrieBuilder.cs`の整理**:
  - これらのクラスを`Builder`名前空間に移動し、タイピング機能の内部的な構築プロセスの一部であることを明確にすることを検討します。
## 💡 フェーズ5: 将来的なアイデア
- [ ] **アイテムの連鎖効果の設計**
    - [ ] 爆弾などの一部のアイテムについては、爆発により、他の爆弾を爆発させることができるようにしたい。同時に、この連鎖の影響を受けないアイテムと影響を受けるアイテムを上手く管理したい。
- [ ] **アイテムレーダーや通った通路のミニマップ導入**:
    - [ ] **アイテムレーダー**: 小さい小窓などで四隅の端に、アイテムの存在を示すミニマップ機能を実装し、追加する。
    - [ ] **通った通路のミニマップ**: 近くを通ると、ミニマップの画面に対して少し明るめの色で道があると示すマップの作製

- [ ] **クロススクリーンエフェクトの実装**
    - [ ] アイテム効果をよりダイナミックに表現するため、画面分割の境界を越えて移動するエフェクトを実装する。
    - [ ] **例**: サンダーアイテムを取得したプレイヤーの画面上部から光線が発射され、相手プレイヤーの画面上部からその光線が降ってきて着弾する、といった一連の演出。
    - [ ] **技術的課題**: 各プレイヤーのカメラは異なる`Render Texture`や`Viewport`を持つため、複数のカメラをまたいで描画されるエフェクトには、UIレイヤーや別のカメラを使った特殊な実装が必要になる可能性が高い。

---

## ✅ 完了済みタスク (Completed)